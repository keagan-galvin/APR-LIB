<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Samples - Buttons</title>
    <!-- 3rd Party Plugins -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/solid.css" integrity="sha384-rdyFrfAIC05c5ph7BKz3l5NG5yEottvO/DQ0dCrwD8gzeQDjYBHNr1ucUpQuljos"
        crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/brands.css" integrity="sha384-QT2Z8ljl3UupqMtQNmPyhSPO/d5qbrzWmFxJqmY7tqoTuT2YrQLEqzvVOP2cT5XW"
        crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/fontawesome.css" integrity="sha384-u5J7JghGz0qUrmEsWzBQkfvc8nK3fUT7DCaQzNQ+q4oEXhGSx+P2OqjWsfIRB8QT"
        crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Roboto:400,400i,500,700,700i" rel="stylesheet">

    <link href="../../dist/styles.css" type="text/css" rel="stylesheet" />

    <script defer src="../../dist/polyfills.min.js" type="text/javascript"></script>
    <script defer src="../../dist/lib.min.js" type="text/javascript"></script>
</head>

<body>
    <main style="padding: 2rem">
        <div class="card primary">
            <div class="card-toolbar toolbar">
                <h1 class="label">Contact Form</h1>
                <div class="options">
                    <div class="group">
                        <button class="flat primary">Submit</button>
                    </div>
                </div>
                <div class="progress accent">
                    <div class="indeterminate"></div>
                </div>
            </div>
            <div class="card-content content-padding">
                <input name="hiddenField" type="hidden" value="something" />

                <input name="EmailAddress" data-note="this is a sample note" placeholder="Email Address" email-error="Invalid email address"
                    type="email" required minLength="2" maxLength="250" />

                <div class="form-group row">
                    <input name="first" placeholder="First Name" type="text" required minLength="2" maxLength="100" />
                    <input name="middle" placeholder="Middle Name" type="text" required minLength="1" maxLength="1" />
                    <input name="last" placeholder="Last Name" type="text" required minLength="2" maxLength="100" />
                </div>

                <input name="Address1" placeholder="Address 1" type="text" required minLength="2" maxLength="250" />

                <div class="form-group row">
                    <input name="City" placeholder="City" type="text" required minLength="2" maxLength="100" />
                    <select name="State" placeholder="State" required />
                    <input name="Zip" placeholder="Zip Code" type="text" required required-error="Invalid Zip Code"
                        pattern="^[0-9]{5}(?:-[0-9]{4})?$" pattern-error="Invalid Zip Code" />
                </div>

                <div class="form-input">
                    <label class="field-group">
                        <span class="decorator">(</span>
                        <input type="text" placeholder="000" style="width: 28px" name="PhoneAreaCode" pattern="\d{3}"
                            required minlength="3" maxlength="3" required-error="Invalid Phone Number" pattern-error="Invalid Phone Number"
                            minlength-error="Invalid Phone Number" maxlength-error="Invalid Phone Number">
                        <span class="decorator">)</span>
                        <input type="text" placeholder="000" style="width: 28px" name="PhonePrefix" pattern="\d{3}"
                            required minlength="3" maxlength="3" required-error="Invalid Phone Number" pattern-error="Invalid Phone Number"
                            minlength-error="Invalid Phone Number" maxlength-error="Invalid Phone Number">
                        <span class="decorator">-</span>
                        <input type="text" placeholder="0000" style="width: 38px" name="PhoneSuffix" pattern="\d{4}"
                            required minlength="4" maxlength="4" required-error="Invalid Phone Number" pattern-error="Invalid Phone Number"
                            minlength-error="Invalid Phone Number" maxlength-error="Invalid Phone Number">
                        <span class="decorator" style="color: #999;">&nbsp;&nbsp;+</span>
                        <input type="text" placeholder="Ext." style="width: 38px" name="PhoneExtension" pattern="\d+$"
                            maxlength="4" pattern-error="Invalid Phone Number" maxlength-error="Invalid Phone Number">
                        <span class="placeholder fixed">Phone Number*</span>
                    </label>
                    <div class="error-message"></div>
                    <div class="note"></div>
                </div>
            </div>
        </div>
    </main>
</body>

<script defer>
    document.addEventListener("DOMContentLoaded", function () {
        var statesSrc =
            'https://gist.githubusercontent.com/mshafrir/2646763/raw/8b0dbb93521f5d6889502305335104218454c2bf/states_titlecase.json';

        var form = FormHelpers.Form(document.querySelector('.card'), submit);

        //temporary bug fix; has been patched in build.
        console.log(form);
        form.element.setAttribute('novalidate', '');

        loadFormData();

        function submit(isValid, data) {
            if (isValid) {
                form.isLoading = true;
                setTimeout(function () {
                    form.isLoading = false;
                    Toaster.toast({
                        message: 'Conatact has been saved.'
                    });
                }, 1000);
            }
        }

        function loadFormData() {
            var select = form.field('State');

            // simulat long request
            var minTime = 1000;
            var now = new Date();

            form.isLoading = true;

            HttpService.get(statesSrc).then(
                response => {

                    var span = new Date() - now;

                    if (span >= minTime) set();
                    else setTimeout(set, minTime - span);


                    function set() {
                        var options = [];

                        for (var i = 0; i < response.data.length; i++) {
                            options.push({
                                text: response.data[i].name,
                                value: response.data[i].abbreviation
                            });
                        }

                        select.options = options;

                        form.isLoading = false;
                    }
                },
                error => console.log(error));

        }
    });
</script>

</html>